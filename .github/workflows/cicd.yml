  deploy:
    needs: build
    runs-on: self-hosted 
    steps:
      - name: Pull image from docker hub
        run: docker pull hunderedacress/100acressfront:latest 

      - name: Delete old container
        run: |
            if [ "$(docker ps -aq -f name=hundredacress-frontend-container)" ]; then
            docker rm -f hundredacress-frontend-container
            fi

      - name: Free port 3000 if already in use
        run: |
          if lsof -i :3000; then
            sudo kill -9 $(lsof -t -i :3000)
          fi

      - name: Run Docker Container
        run: docker run -d -p 3000:80 --name hundredacress-frontend-container hunderedacress/100acressfront
